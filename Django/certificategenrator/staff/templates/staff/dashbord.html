  {% load static %}
  <!DOCTYPE html>
  <html lang="en">
  <head>
<link rel="shortcut icon" href="{% static 'icon.png' %}" type="image/x-icon">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Staff Dashboard</title>
    <link rel="stylesheet" href="{% static 'css/flowbite.min.css' %}">
    <script src="{% static 'js/flowbite.min.js' %}"></script>
        <link href="{% static 'css/flowbite.min.css' %}" rel="stylesheet" />

    <style>
      .gradient-text {
        background: linear-gradient(90deg, #ec4899, #8b5cf6);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }
      .bg-gradient-header {
        background: linear-gradient(90deg, #ec4899, #8b5cf6);
      }
      /* Ensure modal overlay covers entire screen on mobile */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 50;
      }
      /* Better touch targets */
      .touch-target {
        min-height: 44px;
        min-width: 44px;
      }
    </style>
  </head>

  <body class="bg-gray-100">
    <!-- Navigation -->
    <nav class="bg-gradient-header shadow-md">
      <div class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8">
        <div class="flex justify-between h-14 sm:h-16 items-center">
          <a href="#" class="text-white font-extrabold text-lg sm:text-xl truncate">Staff Dashboard</a>
         <a href="{% url 'app:logout' %}" class="bg-white/20 hover:bg-white/30 text-white font-bold py-2 px-6 rounded-full shadow-md transition duration-300 backdrop-blur-sm">
            <span class="hidden md:inline">Logout</span>
            <span class="md:hidden">⏻</span>
          </a>

        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-3 sm:px-4 py-4 sm:py-8">
      <!-- Action Buttons -->
      <div class="mb-6 grid grid-cols-1 sm:grid-cols-2 lg:flex lg:justify-end gap-3 lg:gap-4">
        <a href="{% url 'staff:excel_attendance' %}" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 text-center text-sm sm:text-base touch-target flex items-center justify-center">
          Download Attendance
        </a>
        <a href="{% url 'staff:excel_view' %}" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 text-center text-sm sm:text-base touch-target flex items-center justify-center">
          Download Work Update
        </a>
        <a href="{% url 'staff:attendance' %}" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 text-center text-sm sm:text-base touch-target flex items-center justify-center">
          Student Attendance
        </a>
        <a href="{% url 'staff:add_student' %}" class="bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 text-center text-sm sm:text-base touch-target flex items-center justify-center">
          Add Student
        </a>
      </div>

      <!-- Work Update Form -->
      <section class="w-full bg-white rounded-xl shadow-md p-4 sm:p-6 border border-gray-200 mb-6 sm:mb-8">
        <h2 class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-pink-600">Work Update</h2>
        <form class="space-y-4 sm:space-y-5" id="workForm1" method="POST" action="{% url 'staff:add_work' %}">
          {% csrf_token %}
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Select Time Slot</label>
            <select name="time_slot" class="w-full border border-gray-300 rounded-lg px-3 sm:px-4 py-3 sm:py-2 focus:outline-none focus:ring-2 focus:ring-pink-500 text-base touch-target">
              <option value="ten_to_twelve">10:00 AM – 12:00 PM</option>
              <option value="one_to_three">1:00 PM – 3:00 PM</option>
              <option value="three_to_five">3:00 PM – 5:00 PM</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Work Description</label>
            <textarea name="work" rows="4" class="w-full border border-gray-300 rounded-lg px-3 sm:px-4 py-3 sm:py-2 focus:outline-none focus:ring-2 focus:ring-pink-500 text-base resize-none" placeholder="Describe your work here..."></textarea>
          </div>
          <button type="submit" class="w-full bg-pink-500 hover:bg-pink-600 text-white font-semibold py-3 sm:py-2.5 px-4 rounded-lg shadow-md transition duration-300 text-base touch-target">
            Submit Work
          </button>
        </form>
      </section>

      <!-- Work Display -->
      <section class="w-full bg-white rounded-xl shadow-md p-4 sm:p-6 border border-gray-200">
        <h2 class="text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-pink-600">Work Display</h2>
        <div class="space-y-4">
          {% for time_slot, works in grouped_work.items %}
            <div class="bg-gray-50 p-3 sm:p-4 rounded-lg">
              <p class="font-semibold text-sm sm:text-base mb-3">
                Time Slot:
                {% if time_slot == "ten_to_twelve" %}10:00 AM – 12:00 PM
                {% elif time_slot == "one_to_three" %}1:00 PM – 3:00 PM
                {% else %}3:00 PM – 5:00 PM
                {% endif %}
              </p>
              {% for work in works %}
              <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-0 mt-3 p-2 bg-white rounded border border-gray-100">
                <p class="text-sm sm:text-base break-words flex-1">{{ work.work }}</p>
                <button type="button"
                  class="text-sm text-pink-600 hover:text-pink-800 font-medium py-2 px-3 rounded bg-pink-50 hover:bg-pink-100 transition-colors duration-200 touch-target self-start sm:self-auto"
                  data-modal-target="editWorkModal"
                  data-modal-toggle="editWorkModal"
                  onclick="populateEditModal('{{ work.id }}', '{{ work.work|escapejs }}')"
                >
                  Edit
                </button>
              </div>
              {% endfor %}
            </div>
          {% endfor %}
        </div>
      </section>
    </main>

    <!-- Edit Work Modal -->
    <div id="editWorkModal" tabindex="-1" aria-hidden="true" class="fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto h-full max-h-full modal-overlay">
      <div class="relative w-full max-w-md max-h-full mx-auto mt-8 sm:mt-16">
        <div class="relative bg-white rounded-lg shadow-lg">
          <div class="flex items-start justify-between p-4 sm:p-6 border-b rounded-t">
            <h3 class="text-lg sm:text-xl font-semibold text-gray-900">Edit Work</h3>
            <button type="button" class="text-gray-400 hover:text-gray-900 rounded-lg text-lg p-2 ml-auto touch-target" data-modal-hide="editWorkModal">
              ✕
            </button>
          </div>
          <form method="POST" action="{% url 'staff:edit_work' %}">
            {% csrf_token %}
            <div class="p-4 sm:p-6 space-y-4">
              <input type="hidden" name="work_id" id="work-id-input">
              <div>
                <label for="work" class="block mb-2 text-sm font-medium text-gray-900">Work Description</label>
                <textarea name="work" id="work-input" rows="4" class="bg-gray-50 border border-gray-300 text-gray-900 text-base rounded-lg w-full p-3 resize-none focus:outline-none focus:ring-2 focus:ring-pink-500" required></textarea>
              </div>
            </div>
            <div class="flex flex-col sm:flex-row items-stretch sm:items-center p-4 sm:p-6 space-y-2 sm:space-y-0 sm:space-x-2 border-t border-gray-200 rounded-b">
              <button type="submit" class="text-white bg-pink-600 hover:bg-pink-700 font-medium rounded-lg text-base px-5 py-3 touch-target order-2 sm:order-1">
                Save Changes
              </button>
              <button type="button" class="text-gray-500 bg-white hover:bg-gray-100 rounded-lg border border-gray-200 text-base px-5 py-3 touch-target order-1 sm:order-2" data-modal-hide="editWorkModal">
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal Population Script -->
    <script>
      function populateEditModal(workId, workText) {
        document.getElementById('work-id-input').value = workId;
        document.getElementById('work-input').value = workText;
      }

      // Close modal when clicking outside
      document.addEventListener('click', function(event) {
        const modal = document.getElementById('editWorkModal');
        if (event.target === modal) {
          modal.classList.add('hidden');
        }
      });

      // Prevent zoom on iOS when focusing inputs
      document.addEventListener('touchstart', function() {}, true);
    </script>
  </body>
  </html> 